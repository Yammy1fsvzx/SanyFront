import React, { useState } from 'react';
import Link from 'next/link';
import styles from './ProductCard.module.scss';
import { Heart } from 'react-feather';

interface Product {
  id: number;
  brand: string;
  name: string;
  price: string;
  reference?: string;
  image: string;
  isNew?: boolean;
  location?: string;
}

interface ProductCardProps {
  product: Product & { price: string };
}

const ProductCard: React.FC<ProductCardProps> = ({ product }) => {
  const [isActive, setIsActive] = useState(false);
  const statusText = product.isNew ? 'Новый' : 'Использованный';

  const toggleFavorite = (e: React.MouseEvent) => {
    e.stopPropagation();
    setIsActive((prev) => !prev);
  };

  return (
    <div className={styles.productItem}>
      <div className={styles.catalogItemTitle}>
        <div className={styles.titleMain}>
          <p className={styles.itemName}>{product.brand}</p>
        </div>
        <div className={styles.subtitle}>
          <p className={styles.subtitleText}>{product.name}</p>
        </div>
      </div>
      <div className={styles.catalogItemImg}>
        <div className={styles.catalogItemImgInner}>
          <img src={product.image} alt={product.name} loading="lazy" className={styles.catalogItemImgObject} />
        </div>

        <div className={styles.actionFavorite} onClick={toggleFavorite}>
          <Heart className={`${styles.heartIcon} ${isActive ? styles.active : ''}`} />
        </div>
        {statusText === 'Новый' ? (
          <div className={styles.statusUsed}>
            <div className={styles.statusUsedIcon}></div>
            <span className={styles.statusUsedTooltip}>
              <svg width="42" height="14" viewBox="0 0 42 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M0.811524 14C0.664857 14 0.544857 13.9533 0.451524 13.86C0.35819 13.7667 0.311523 13.6467 0.311523 13.5V0.500001C0.311523 0.353334 0.35819 0.233333 0.451524 0.140001C0.544857 0.0466669 0.664857 0 0.811524 0H2.93152C3.15819 0 3.31819 0.0533334 3.41152 0.16C3.51819 0.253333 3.58486 0.326666 3.61152 0.38L8.49152 8.08V0.500001C8.49152 0.353334 8.53819 0.233333 8.63152 0.140001C8.72486 0.0466669 8.84486 0 8.99152 0H11.3915C11.5382 0 11.6582 0.0466669 11.7515 0.140001C11.8449 0.233333 11.8915 0.353334 11.8915 0.500001V13.5C11.8915 13.6333 11.8449 13.7533 11.7515 13.86C11.6582 13.9533 11.5382 14 11.3915 14H9.25152C9.03819 14 8.87819 13.9467 8.77152 13.84C8.67819 13.7333 8.61819 13.66 8.59152 13.62L3.71152 6.22V13.5C3.71152 13.6467 3.66486 13.7667 3.57152 13.86C3.47819 13.9533 3.35819 14 3.21152 14H0.811524Z" fill="#E7E7E7"></path>
                <path d="M15.1865 14C15.0399 14 14.9199 13.9533 14.8265 13.86C14.7332 13.7667 14.6865 13.6467 14.6865 13.5V0.500001C14.6865 0.353334 14.7332 0.233333 14.8265 0.140001C14.9199 0.0466669 15.0399 0 15.1865 0H24.5265C24.6732 0 24.7932 0.0466669 24.8865 0.140001C24.9799 0.233333 25.0265 0.353334 25.0265 0.500001V2.38C25.0265 2.52667 24.9799 2.64667 24.8865 2.74C24.7932 2.83333 24.6732 2.88 24.5265 2.88H18.1465V5.58H24.0865C24.2332 5.58 24.3532 5.63333 24.4465 5.74C24.5399 5.83333 24.5865 5.95333 24.5865 6.1V7.84C24.5865 7.97333 24.5399 8.09333 24.4465 8.2C24.3532 8.29333 24.2332 8.34 24.0865 8.34H18.1465V11.12H24.6865C24.8332 11.12 24.9532 11.1667 25.0465 11.26C25.1399 11.3533 25.1865 11.4733 25.1865 11.62V13.5C25.1865 13.6467 25.1399 13.7667 25.0465 13.86C24.9532 13.9533 24.8332 14 24.6865 14H15.1865Z" fill="#E7E7E7"></path>
                <path d="M29.7 14C29.4733 14 29.2933 13.9333 29.16 13.8C29.0266 13.6667 28.9466 13.5133 28.92 13.34L26.74 0.56C26.7266 0.533334 26.72 0.506667 26.72 0.48C26.72 0.453333 26.72 0.433334 26.72 0.420001C26.72 0.313334 26.76 0.22 26.84 0.140001C26.9333 0.0466669 27.0333 0 27.14 0H29.62C29.9933 0 30.2 0.146667 30.24 0.44L31.54 8.26L32.98 3.64C33.02 3.53333 33.0866 3.42 33.18 3.3C33.2733 3.16667 33.4266 3.1 33.64 3.1H35.08C35.3066 3.1 35.4666 3.16667 35.56 3.3C35.6533 3.42 35.7133 3.53333 35.74 3.64L37.18 8.24L38.48 0.44C38.52 0.146667 38.7266 0 39.1 0H41.58C41.7 0 41.8 0.0466669 41.88 0.140001C41.96 0.22 42 0.313334 42 0.420001C42 0.433334 42 0.453333 42 0.48C42 0.506667 42 0.533334 42 0.56L39.82 13.34C39.7933 13.5133 39.7133 13.6667 39.58 13.8C39.4466 13.9333 39.2666 14 39.04 14H37.14C36.9133 14 36.74 13.94 36.62 13.82C36.5 13.7 36.42 13.5867 36.38 13.48L34.36 7.76L32.34 13.48C32.3 13.5867 32.22 13.7 32.1 13.82C31.9933 13.94 31.8266 14 31.6 14H29.7Z" fill="#E7E7E7"></path>
              </svg>
            </span>
          </div>
        ) : (
          <div className={styles.statusUsed}>
            <div className={styles.statusUsedIcon}></div>
            <span className={styles.statusUsedTooltip}>
              <svg width="133" height="16" viewBox="0 0 133 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M0.555556 15.7778C0.392593 15.7778 0.259259 15.7259 0.155556 15.6222C0.0518519 15.5185 0 15.3852 0 15.2222V0.777778C0 0.614815 0.0518519 0.481481 0.155556 0.377778C0.259259 0.274074 0.392593 0.222222 0.555556 0.222222H6.77778C8.00741 0.222222 9.07407 0.414815 9.97778 0.8C10.8963 1.17037 11.6074 1.73333 12.1111 2.48889C12.6296 3.24444 12.8889 4.2 12.8889 5.35556C12.8889 6.4963 12.6296 7.43704 12.1111 8.17778C11.6074 8.91852 10.8963 9.46667 9.97778 9.82222C9.07407 10.1778 8.00741 10.3556 6.77778 10.3556H4.13333V15.2222C4.13333 15.3852 4.07407 15.5185 3.95556 15.6222C3.85185 15.7259 3.71852 15.7778 3.55556 15.7778H0.555556ZM4.06667 7.28889H6.66667C7.3037 7.28889 7.80741 7.12593 8.17778 6.8C8.56296 6.47407 8.75556 5.97778 8.75556 5.31111C8.75556 4.74815 8.59259 4.27407 8.26667 3.88889C7.94074 3.5037 7.40741 3.31111 6.66667 3.31111H4.06667V7.28889Z" fill="#E7E7E7"></path>
                <path d="M15.5729 15.7778C15.41 15.7778 15.2766 15.7259 15.1729 15.6222C15.0692 15.5185 15.0174 15.3852 15.0174 15.2222V0.777778C15.0174 0.614815 15.0692 0.481481 15.1729 0.377778C15.2766 0.274074 15.41 0.222222 15.5729 0.222222H21.6174C23.5285 0.222222 25.0322 0.666666 26.1285 1.55556C27.2396 2.42963 27.7951 3.67407 27.7951 5.28889C27.7951 6.34074 27.5359 7.22963 27.0174 7.95556C26.5137 8.68148 25.847 9.22963 25.0174 9.6L28.084 15.0667C28.1285 15.1556 28.1507 15.237 28.1507 15.3111C28.1507 15.4296 28.0988 15.5407 27.9951 15.6444C27.9062 15.7333 27.7951 15.7778 27.6618 15.7778H24.7285C24.447 15.7778 24.2396 15.7111 24.1062 15.5778C23.9729 15.4296 23.8766 15.2963 23.8174 15.1778L21.284 10.2889H18.9951V15.2222C18.9951 15.3852 18.9433 15.5185 18.8396 15.6222C18.7359 15.7259 18.6025 15.7778 18.4396 15.7778H15.5729ZM18.9951 7.15556H21.5729C22.2692 7.15556 22.7877 6.98519 23.1285 6.64444C23.484 6.3037 23.6618 5.83704 23.6618 5.24444C23.6618 4.66667 23.4914 4.2 23.1507 3.84445C22.8248 3.48889 22.2988 3.31111 21.5729 3.31111H18.9951V7.15556Z" fill="#E7E7E7"></path>
                <path d="M30.9375 15.7778C30.7745 15.7778 30.6412 15.7259 30.5375 15.6222C30.4338 15.5185 30.3819 15.3852 30.3819 15.2222V0.777778C30.3819 0.614815 30.4338 0.481481 30.5375 0.377778C30.6412 0.274074 30.7745 0.222222 30.9375 0.222222H41.3153C41.4782 0.222222 41.6116 0.274074 41.7153 0.377778C41.819 0.481481 41.8708 0.614815 41.8708 0.777778V2.86667C41.8708 3.02963 41.819 3.16296 41.7153 3.26667C41.6116 3.37037 41.4782 3.42222 41.3153 3.42222H34.2264V6.42222H40.8264C40.9894 6.42222 41.1227 6.48148 41.2264 6.6C41.3301 6.7037 41.3819 6.83704 41.3819 7V8.93333C41.3819 9.08148 41.3301 9.21482 41.2264 9.33333C41.1227 9.43704 40.9894 9.48889 40.8264 9.48889H34.2264V12.5778H41.4931C41.656 12.5778 41.7894 12.6296 41.8931 12.7333C41.9968 12.837 42.0486 12.9704 42.0486 13.1333V15.2222C42.0486 15.3852 41.9968 15.5185 41.8931 15.6222C41.7894 15.7259 41.656 15.7778 41.4931 15.7778H30.9375Z" fill="#E7E7E7"></path>
                <path d="M44.6894 10.7111C44.5264 10.7111 44.3931 10.6593 44.2894 10.5556C44.1857 10.4519 44.1339 10.3185 44.1339 10.1556V8.06667C44.1339 7.9037 44.1857 7.77037 44.2894 7.66667C44.3931 7.56296 44.5264 7.51111 44.6894 7.51111H51.645C51.8079 7.51111 51.9413 7.56296 52.045 7.66667C52.1487 7.77037 52.2005 7.9037 52.2005 8.06667V10.1556C52.2005 10.3185 52.1487 10.4519 52.045 10.5556C51.9413 10.6593 51.8079 10.7111 51.645 10.7111H44.6894Z" fill="#E7E7E7"></path>
                <path d="M61.3686 16C60.0056 16 58.8204 15.7778 57.813 15.3333C56.8056 14.8889 56.0204 14.2222 55.4575 13.3333C54.8945 12.4296 54.5834 11.3037 54.5241 9.95556C54.5093 9.31852 54.5019 8.68148 54.5019 8.04444C54.5019 7.40741 54.5093 6.76296 54.5241 6.11111C54.5834 4.77778 54.8945 3.65926 55.4575 2.75556C56.0352 1.83704 56.8278 1.14815 57.8352 0.688889C58.8427 0.22963 60.0204 0 61.3686 0C62.7019 0 63.8723 0.22963 64.8797 0.688889C65.9019 1.14815 66.7019 1.83704 67.2797 2.75556C67.8575 3.65926 68.1686 4.77778 68.213 6.11111C68.2426 6.76296 68.2575 7.40741 68.2575 8.04444C68.2575 8.68148 68.2426 9.31852 68.213 9.95556C68.1538 11.3037 67.8426 12.4296 67.2797 13.3333C66.7167 14.2222 65.9315 14.8889 64.9241 15.3333C63.9167 15.7778 62.7315 16 61.3686 16ZM61.3686 12.8C62.1538 12.8 62.7908 12.563 63.2797 12.0889C63.7834 11.6148 64.0501 10.8593 64.0797 9.82222C64.1093 9.17037 64.1241 8.55556 64.1241 7.97778C64.1241 7.4 64.1093 6.8 64.0797 6.17778C64.0501 5.48148 63.9167 4.91852 63.6797 4.48889C63.4575 4.04444 63.1464 3.71852 62.7464 3.51111C62.3464 3.3037 61.8871 3.2 61.3686 3.2C60.8649 3.2 60.413 3.3037 60.013 3.51111C59.613 3.71852 59.2945 4.04444 59.0575 4.48889C58.8204 4.91852 58.6871 5.48148 58.6575 6.17778C58.6426 6.8 58.6352 7.4 58.6352 7.97778C58.6352 8.55556 58.6426 9.17037 58.6575 9.82222C58.7019 10.8593 58.9686 11.6148 59.4575 12.0889C59.9464 12.563 60.5834 12.8 61.3686 12.8Z" fill="#E7E7E7"></path>
                <path d="M73.1486 15.7778C72.8968 15.7778 72.6968 15.7037 72.5486 15.5556C72.4005 15.4074 72.3116 15.237 72.2819 15.0444L69.8597 0.844444C69.8449 0.814815 69.8375 0.785185 69.8375 0.755555C69.8375 0.725926 69.8375 0.703704 69.8375 0.688889C69.8375 0.570371 69.8819 0.466667 69.9708 0.377778C70.0745 0.274074 70.1856 0.222222 70.3042 0.222222H73.0597C73.4745 0.222222 73.7042 0.385185 73.7486 0.711111L75.1931 9.4L76.7931 4.26667C76.8375 4.14815 76.9116 4.02222 77.0153 3.88889C77.119 3.74074 77.2893 3.66667 77.5264 3.66667H79.1264C79.3782 3.66667 79.556 3.74074 79.6597 3.88889C79.7634 4.02222 79.8301 4.14815 79.8597 4.26667L81.4597 9.37778L82.9042 0.711111C82.9486 0.385185 83.1782 0.222222 83.5931 0.222222H86.3486C86.4819 0.222222 86.5931 0.274074 86.6819 0.377778C86.7708 0.466667 86.8153 0.570371 86.8153 0.688889C86.8153 0.703704 86.8153 0.725926 86.8153 0.755555C86.8153 0.785185 86.8153 0.814815 86.8153 0.844444L84.3931 15.0444C84.3634 15.237 84.2745 15.4074 84.1264 15.5556C83.9782 15.7037 83.7782 15.7778 83.5264 15.7778H81.4153C81.1634 15.7778 80.9708 15.7111 80.8375 15.5778C80.7042 15.4444 80.6153 15.3185 80.5708 15.2L78.3264 8.84444L76.0819 15.2C76.0375 15.3185 75.9486 15.4444 75.8153 15.5778C75.6968 15.7111 75.5116 15.7778 75.2597 15.7778H73.1486Z" fill="#E7E7E7"></path>
                <path d="M89.6615 15.7778C89.4985 15.7778 89.3652 15.7259 89.2615 15.6222C89.1578 15.5185 89.1059 15.3852 89.1059 15.2222V0.777778C89.1059 0.614815 89.1578 0.481481 89.2615 0.377778C89.3652 0.274074 89.4985 0.222222 89.6615 0.222222H92.017C92.2689 0.222222 92.4466 0.281481 92.5503 0.4C92.6689 0.503703 92.7429 0.585185 92.7726 0.644444L98.1948 9.2V0.777778C98.1948 0.614815 98.2466 0.481481 98.3503 0.377778C98.454 0.274074 98.5874 0.222222 98.7503 0.222222H101.417C101.58 0.222222 101.713 0.274074 101.817 0.377778C101.921 0.481481 101.973 0.614815 101.973 0.777778V15.2222C101.973 15.3704 101.921 15.5037 101.817 15.6222C101.713 15.7259 101.58 15.7778 101.417 15.7778H99.0392C98.8022 15.7778 98.6244 15.7185 98.5059 15.6C98.4022 15.4815 98.3355 15.4 98.3059 15.3556L92.8837 7.13333V15.2222C92.8837 15.3852 92.8318 15.5185 92.7281 15.6222C92.6244 15.7259 92.4911 15.7778 92.3281 15.7778H89.6615Z" fill="#E7E7E7"></path>
                <path d="M105.634 15.7778C105.471 15.7778 105.337 15.7259 105.234 15.6222C105.13 15.5185 105.078 15.3852 105.078 15.2222V0.777778C105.078 0.614815 105.13 0.481481 105.234 0.377778C105.337 0.274074 105.471 0.222222 105.634 0.222222H116.011C116.174 0.222222 116.308 0.274074 116.411 0.377778C116.515 0.481481 116.567 0.614815 116.567 0.777778V2.86667C116.567 3.02963 116.515 3.16296 116.411 3.26667C116.308 3.37037 116.174 3.42222 116.011 3.42222H108.923V6.42222H115.523C115.686 6.42222 115.819 6.48148 115.923 6.6C116.026 6.7037 116.078 6.83704 116.078 7V8.93333C116.078 9.08148 116.026 9.21482 115.923 9.33333C115.819 9.43704 115.686 9.48889 115.523 9.48889H108.923V12.5778H116.189C116.352 12.5778 116.486 12.6296 116.589 12.7333C116.693 12.837 116.745 12.9704 116.745 13.1333V15.2222C116.745 15.3852 116.693 15.5185 116.589 15.6222C116.486 15.7259 116.352 15.7778 116.189 15.7778H105.634Z" fill="#E7E7E7"></path>
                <path d="M119.826 15.7778C119.663 15.7778 119.53 15.7259 119.426 15.6222C119.323 15.5185 119.271 15.3852 119.271 15.2222V0.777778C119.271 0.614815 119.323 0.481481 119.426 0.377778C119.53 0.274074 119.663 0.222222 119.826 0.222222H125.604C127.056 0.222222 128.293 0.459259 129.315 0.933333C130.337 1.39259 131.123 2.07407 131.671 2.97778C132.219 3.86667 132.515 4.97037 132.56 6.28889C132.575 6.94074 132.582 7.51111 132.582 8C132.582 8.48889 132.575 9.05185 132.56 9.68889C132.5 11.0667 132.204 12.2074 131.671 13.1111C131.152 14.0148 130.389 14.6889 129.382 15.1333C128.389 15.563 127.167 15.7778 125.715 15.7778H119.826ZM123.249 12.5778H125.604C126.241 12.5778 126.767 12.4815 127.182 12.2889C127.612 12.0815 127.93 11.763 128.137 11.3333C128.36 10.9037 128.478 10.3407 128.493 9.64444C128.523 9.21482 128.537 8.82963 128.537 8.48889C128.552 8.14815 128.552 7.80741 128.537 7.46667C128.537 7.12593 128.523 6.74815 128.493 6.33333C128.463 5.32593 128.197 4.59259 127.693 4.13333C127.204 3.65926 126.471 3.42222 125.493 3.42222H123.249V12.5778Z" fill="#E7E7E7"></path>
              </svg>
            </span>
          </div>
        )}
      </div>

      <div className={styles.catalogItemInfo}>
          <div className={styles.catalogMarker}>
            <div className={styles.badgeElement}>Limited Editions</div>
          </div>
          <div className={styles.reference}>
            <p className={styles.refText}>
              <span className={styles.refLabel}>Референс: </span>{product.reference || 'N/A'}
            </p>
          </div>
          <div className={styles.priceRow}>
            <p className={styles.itemPriceText}>{'$' + product.price || 'Цена по запросу'}</p>
          </div>
      </div>
    </div>
  );
};

export default ProductCard;
